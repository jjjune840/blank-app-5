# Streamlit ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ stë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤. ì•ìœ¼ë¡œ st.ì„ ì‚¬ìš©í•˜ì—¬ Streamlitì˜ ê¸°ëŠ¥ì„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
import streamlit as st

# --- ì•±ì˜ ê¸°ë³¸ ì„¤ì • ---
# ì›¹ ë¸Œë¼ìš°ì € íƒ­ì— í‘œì‹œë  ì œëª©ê³¼ ì•„ì´ì½˜ì„ ì„¤ì •í•©ë‹ˆë‹¤.
st.set_page_config(
    page_title="MBTI í•™ìŠµ ìœ í˜• ì§„ë‹¨",
    page_icon="ğŸ§ ",
)

# --- MBTI ìœ í˜•ë³„ í•™ìŠµ ì „ëµ ë”•ì…”ë„ˆë¦¬ ---
# ê° MBTI ìœ í˜•ì— ë§ëŠ” í•™ìŠµ ì „ëµ ì„¤ëª…ì„ ë¯¸ë¦¬ ì €ì¥í•´ ë‘¡ë‹ˆë‹¤.
learning_styles = {
    "ISTJ": "í˜„ì‹¤ì ì´ê³  ì²´ê³„ì ì´ì–´ì„œ, ëª…í™•í•œ ëª©í‘œì™€ ê³„íšì„ ì„¸ì›Œ ë‹¨ê³„ë³„ë¡œ í•™ìŠµí•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì¡°ìš©í•˜ê³  ì •ë¦¬ëœ í™˜ê²½ì—ì„œ ì§‘ì¤‘ë ¥ì´ ë†’ìŠµë‹ˆë‹¤.",
    "ISFJ": "ë‹¤ë¥¸ ì‚¬ëŒì„ ë•ëŠ” ê²ƒì—ì„œ ë³´ëŒì„ ëŠë¼ë©°, ì‹¤ìš©ì ì´ê³  êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµí•©ë‹ˆë‹¤. ë”°ëœ»í•˜ê³  ì§€ì§€ì ì¸ ë¶„ìœ„ê¸°ì—ì„œ í•™ìŠµ íš¨ê³¼ê°€ ì¢‹ìŠµë‹ˆë‹¤.",
    "INFJ": "í†µì°°ë ¥ì´ ë›°ì–´ë‚˜ê³  ì¥ê¸°ì ì¸ ë¹„ì „ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤. í•™ìŠµ ë‚´ìš©ì´ ìì‹ ê³¼ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì–´ë–¤ ì˜ë¯¸ê°€ ìˆëŠ”ì§€ íŒŒì•…í•  ë•Œ ë™ê¸°ë¥¼ ì–»ìŠµë‹ˆë‹¤.",
    "INTJ": "ë…ì°½ì ì´ê³  ë…¼ë¦¬ì ì´ì–´ì„œ, ë³µì¡í•œ ì´ë¡ ì´ë‚˜ ì‹œìŠ¤í…œì„ ì´í•´í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. í˜¼ìì„œ ê¹Šì´ íŒŒê³ ë“œëŠ” í•™ìŠµì„ ì„ í˜¸í•˜ë©°, ë¹„íš¨ìœ¨ì ì¸ ê²ƒì„ ì‹«ì–´í•©ë‹ˆë‹¤.",
    "ISTP": "ë…¼ë¦¬ì ì´ê³  ì‹¤ìš©ì ì´ì–´ì„œ, ì§ì ‘ ì†ìœ¼ë¡œ ë§Œì§€ê³  ê²½í—˜í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ê°€ì¥ ì¢‹ì•„í•©ë‹ˆë‹¤. ì›ë¦¬ë¥¼ íŒŒì•…í•˜ê³  ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê³¼ì •ì—ì„œ ì¬ë¯¸ë¥¼ ëŠë‚ë‹ˆë‹¤.",
    "ISFP": "ì˜¨í™”í•˜ê³  ê°œë°©ì ì´ì–´ì„œ, ì¡°í™”ë¡œìš´ í™˜ê²½ì—ì„œ ììœ ë¡­ê²Œ íƒìƒ‰í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚˜ë©°, ì‹¤ìƒí™œê³¼ ê´€ë ¨ëœ ë‚´ìš©ì— ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤.",
    "INFP": "ì´ìƒì£¼ì˜ì ì´ê³  ì°½ì˜ì ì´ì–´ì„œ, ìì‹ ì˜ ê°€ì¹˜ê´€ê³¼ ê´€ë ¨ëœ ë‚´ìš©ì„ í•™ìŠµí•  ë•Œ ì—´ì •ì„ ë³´ì…ë‹ˆë‹¤. ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ììœ ë¡œìš´ ë¶„ìœ„ê¸°ì—ì„œ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "INTP": "ì§€ì  í˜¸ê¸°ì‹¬ì´ ì™•ì„±í•˜ê³  ë…¼ë¦¬ì ì´ì–´ì„œ, ë³µì¡í•œ ë¬¸ì œë‚˜ ì¶”ìƒì ì¸ ê°œë…ì„ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. í˜¼ìì„œ ê¹Šì´ ìˆê²Œ ë¶„ì„í•˜ê³  í† ë¡ í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ESTP": "ì—ë„ˆì§€ê°€ ë„˜ì¹˜ê³  í–‰ë™ ì§€í–¥ì ì´ì–´ì„œ, ì§ì ‘ ë¶€ë”ªíˆê³  ê²½í—˜í•˜ë©° ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì§€ë£¨í•œ ì´ë¡ ë³´ë‹¤ëŠ” ì‹¤ì œ í™œë™ì„ í†µí•´ í•™ìŠµ íš¨ê³¼ê°€ ê·¹ëŒ€í™”ë©ë‹ˆë‹¤.",
    "ESFP": "ì‚¬êµì ì´ê³  í™œë™ì ì´ì–´ì„œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ì–´ìš¸ë¦¬ë©° ì¬ë¯¸ìˆê²Œ ë°°ìš°ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ê¸ì •ì ì´ê³  í™œê¸°ì°¬ ë¶„ìœ„ê¸°ì—ì„œ í•™ìŠµ íš¨ìœ¨ì´ ë†’ìŠµë‹ˆë‹¤.",
    "ENFP": "ì—´ì •ì ì´ê³  ìƒìƒë ¥ì´ í’ë¶€í•´ì„œ, ë‹¤ì–‘í•œ ê°€ëŠ¥ì„±ì„ íƒìƒ‰í•˜ê³  ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ì‚¬ëŒë“¤ê³¼ ì†Œí†µí•˜ë©° í•¨ê»˜ ì„±ì¥í•˜ëŠ” í•™ìŠµì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ENTP": "ë„ì „ì ì´ê³  ì°½ì˜ì ì´ì–´ì„œ, ê¸°ì¡´ì˜ ë°©ì‹ì— ì˜ë¬¸ì„ ì œê¸°í•˜ê³  ìƒˆë¡œìš´ í•´ê²°ì±…ì„ ì°¾ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒê³¼ ë…¼ìŸí•˜ê³  í† ë¡ í•˜ëŠ” ê³¼ì •ì—ì„œ ì§€ì‹ì„ ì–»ìŠµë‹ˆë‹¤.",
    "ESTJ": "ì²´ê³„ì ì´ê³  í˜„ì‹¤ì ì´ì–´ì„œ, ì •í•´ì§„ ì ˆì°¨ì™€ ê·œì¹™ì— ë”°ë¼ í•™ìŠµí•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ëª©í‘œ ì§€í–¥ì ì´ë©°, í•™ìŠµ ë‚´ìš©ì„ ì‹¤ìƒí™œì— ì ìš©í•˜ëŠ” ê²ƒì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "ESFJ": "ì‚¬êµì ì´ê³  ì±…ì„ê°ì´ ê°•í•´ì„œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í˜‘ë ¥í•˜ê³  ì„œë¡œ ë„ìš°ë©° í•™ìŠµí•  ë•Œ ë™ê¸°ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì¡°í™”ë¡œìš´ ë¶„ìœ„ê¸°ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ë©°, ì¹­ì°¬ê³¼ ê²©ë ¤ì— ê¸ì •ì ìœ¼ë¡œ ë°˜ì‘í•©ë‹ˆë‹¤.",
    "ENFJ": "ë‹¤ë¥¸ ì‚¬ëŒì˜ ì„±ì¥ì„ ë•ëŠ” ê²ƒì—ì„œ ë³´ëŒì„ ëŠë¼ë©°, ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ë¥¼ í†µí•´ ë°°ì›ë‹ˆë‹¤. í•™ìŠµ ë‚´ìš©ì´ ê³µë™ì²´ì— ì–´ë–¤ ê¸ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆëŠ”ì§€ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "ENTJ": "ì „ëµì ì´ê³  í†µì†”ë ¥ì´ ìˆì–´ì„œ, ì¥ê¸°ì ì¸ ëª©í‘œë¥¼ ì„¸ìš°ê³  íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµ ê³„íšì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ë„ì „ì ì¸ ê³¼ì œë¥¼ í•´ê²°í•˜ë©° ì„±ì·¨ê°ì„ ëŠë‚ë‹ˆë‹¤."
}

# --- ì•± ì œëª© ---
st.title("ğŸ§  MBTI í•™ìŠµ ìœ í˜• ì§„ë‹¨")
st.write("---") # êµ¬ë¶„ì„ 

# --- ì§ˆë¬¸ ëª©ë¡ ---
# ì§„ë‹¨ì— ì‚¬ìš©í•  ì§ˆë¬¸ê³¼ ì„ íƒì§€ë¥¼ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.
questions = [
    {
        "q": "1. ê³µë¶€í•  ë•Œ ë‚˜ëŠ”...",
        "options": ["ì¡°ìš©í•œ í™˜ê²½ì—ì„œ í˜¼ì ì§‘ì¤‘í•˜ëŠ” ê²Œ í¸í•˜ë‹¤ (I)", "ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜ ì´ì•¼ê¸°í•˜ë©° ê³µë¶€í•˜ëŠ” ê²Œ ì¦ê²ë‹¤ (E)"],
        "key": "q1"
    },
    {
        "q": "2. ìƒˆë¡œìš´ ê°œë…ì„ ë°°ìš¸ ë•Œ ë‚˜ëŠ”...",
        "options": ["êµ¬ì²´ì ì¸ ì˜ˆì‹œì™€ ì‹¤ì œ ê²½í—˜ì„ í†µí•´ ì´í•´í•œë‹¤ (S)", "ì „ì²´ì ì¸ ê·¸ë¦¼ê³¼ ìˆ¨ê²¨ì§„ ì˜ë¯¸ë¥¼ ë¨¼ì € íŒŒì•…í•œë‹¤ (N)"],
        "key": "q2"
    },
    {
        "q": "3. ê³¼ì œë¥¼ ê²°ì •í•  ë•Œ ë‚˜ëŠ”...",
        "options": ["ë…¼ë¦¬ì ì¸ ë¶„ì„ê³¼ ê°ê´€ì ì¸ ì‚¬ì‹¤ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤ (T)", "ì£¼ë³€ ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì™€ ìƒí™©ì„ ë¨¼ì € ê³ ë ¤í•œë‹¤ (F)"],
        "key": "q3"
    },
    {
        "q": "4. ì£¼ë§ ê³„íšì„ ì„¸ìš¸ ë•Œ ë‚˜ëŠ”...",
        "options": ["ë¯¸ë¦¬ ê³„íšì„ ì„¸ìš°ê³  ê·¸ëŒ€ë¡œ ì‹¤ì²œí•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤ (J)", "ìƒí™©ì— ë”°ë¼ ì¦‰í¥ì ìœ¼ë¡œ í•˜ê³  ì‹¶ì€ ì¼ì„ í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤ (P)"],
        "key": "q4"
    },
     {
        "q": "5. í˜ë“  ì¼ì´ ìƒê²¼ì„ ë•Œ ë‚˜ëŠ”...",
        "options": ["í˜¼ì ì¡°ìš©íˆ ìƒê°í•˜ë©° ì •ë¦¬í•  ì‹œê°„ì´ í•„ìš”í•˜ë‹¤ (I)", "ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ í„¸ì–´ë†“ìœ¼ë©° ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤ (E)"],
        "key": "q5"
    },
    {
        "q": "6. ë‚˜ëŠ” ìŠ¤ìŠ¤ë¡œë¥¼...",
        "options": ["í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì¸ ì‚¬ëŒì´ë¼ê³  ìƒê°í•œë‹¤ (S)", "ìƒìƒë ¥ì´ í’ë¶€í•˜ê³  ì´ìƒì ì¸ ì‚¬ëŒì´ë¼ê³  ìƒê°í•œë‹¤ (N)"],
        "key": "q6"
    }
]

# --- ë‹µë³€ ì €ì¥ ê³µê°„ ---
# st.session_stateëŠ” ì‚¬ìš©ìì˜ ë‹µë³€ê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” íŠ¹ë³„í•œ ê³µê°„ì…ë‹ˆë‹¤.
# ì•±ì´ ìƒˆë¡œê³ ì¹¨ ë˜ì–´ë„ ë°ì´í„°ê°€ ë‚ ì•„ê°€ì§€ ì•ŠìŠµë‹ˆë‹¤.
if 'answers' not in st.session_state:
    st.session_state.answers = {}
if 'result' not in st.session_state:
    st.session_state.result = ""


# --- ì§ˆë¬¸ í™”ë©´ í‘œì‹œ ---
# st.formì„ ì‚¬ìš©í•˜ë©´, ì‚¬ìš©ìê°€ ëª¨ë“  ì§ˆë¬¸ì— ë‹µí•˜ê³  'ì œì¶œ' ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ì•±ì´ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
with st.form("mbti_form"):
    st.subheader("ğŸ‘‡ ì•„ë˜ ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”.")
    
    # questions ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” ê° ì§ˆë¬¸ì„ í™”ë©´ì— ë³´ì—¬ì¤ë‹ˆë‹¤.
    for item in questions:
        question_text = item["q"]
        options_list = item["options"]
        question_key = item["key"]
        
        # st.radioë¥¼ ì‚¬ìš©í•˜ì—¬ ë¼ë””ì˜¤ ë²„íŠ¼ ì§ˆë¬¸ì„ ë§Œë“­ë‹ˆë‹¤.
        st.session_state.answers[question_key] = st.radio(
            question_text,
            options_list,
            index=None, # ì²˜ìŒì— ì•„ë¬´ê²ƒë„ ì„ íƒë˜ì§€ ì•Šë„ë¡ ì„¤ì •
        )
    
    # st.form_submit_buttonì„ ëˆ„ë¥´ë©´ form ì•ˆì˜ ëª¨ë“  ë°ì´í„°ê°€ ì„œë²„ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.
    submitted = st.form_submit_button("ê²°ê³¼ í™•ì¸í•˜ê¸°")


# --- ê²°ê³¼ ê³„ì‚° ë° í‘œì‹œ ---
# 'ê²°ê³¼ í™•ì¸í•˜ê¸°' ë²„íŠ¼ì´ ëˆŒë ¸ì„ ë•Œ ì‹¤í–‰ë  ì½”ë“œì…ë‹ˆë‹¤.
if submitted:
    # ëª¨ë“  ì§ˆë¬¸ì— ë‹µí–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    if None in st.session_state.answers.values():
        st.error("âš ï¸ ëª¨ë“  ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”!")
    else:
        # ê° MBTI ì§€í‘œ(E/I, S/N, T/F, J/P)ì˜ ì ìˆ˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
        scores = {'E': 0, 'I': 0, 'S': 0, 'N': 0, 'T': 0, 'F': 0, 'J': 0, 'P': 0}
        
        # ì‚¬ìš©ìì˜ ë‹µë³€ ë¬¸ìì—´ì—ì„œ ê´„í˜¸ ì•ˆì˜ ì•ŒíŒŒë²³ì„ ì°¾ì•„ ì ìˆ˜ë¥¼ ë§¤ê¹ë‹ˆë‹¤.
        for key, answer in st.session_state.answers.items():
            mbti_char = answer[-2] # ì˜ˆ: "....(E)" -> "E"
            scores[mbti_char] += 1
        
        # ì ìˆ˜ë¥¼ ë¹„êµí•˜ì—¬ ìµœì¢… MBTI ìœ í˜•ì„ ê²°ì •í•©ë‹ˆë‹¤.
        mbti_type = ""
        mbti_type += "E" if scores['E'] > scores['I'] else "I"
        mbti_type += "S" if scores['S'] > scores['N'] else "N"
        mbti_type += "T" if scores['T'] > scores['F'] else "F"
        mbti_type += "J" if scores['J'] > scores['P'] else "P"
        
        # ê²°ê³¼ë¥¼ session_stateì— ì €ì¥í•©ë‹ˆë‹¤.
        st.session_state.result = mbti_type


# ê²°ê³¼ê°€ session_stateì— ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ í™”ë©´ì— ë³´ì—¬ì¤ë‹ˆë‹¤.
if st.session_state.result:
    st.write("---")
    st.header(f"ğŸ“ˆ ë‹¹ì‹ ì˜ í•™ìŠµ ìœ í˜•ì€ '{st.session_state.result}' ì…ë‹ˆë‹¤.")
    
    # ë”•ì…”ë„ˆë¦¬ì—ì„œ ê²°ê³¼ì— ë§ëŠ” ì„¤ëª…ì„ ì°¾ì•„ ë³´ì—¬ì¤ë‹ˆë‹¤.
    st.write(learning_styles.get(st.session_state.result, "ê²°ê³¼ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤."))

    # ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼
    if st.button("ë‹¤ì‹œí•˜ê¸°"):
        # ì„¸ì…˜ ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ì—¬ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
        st.session_state.answers = {}
        st.session_state.result = ""
        st.rerun() # ì•±ì„ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì´ˆê¸° í™”ë©´ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.